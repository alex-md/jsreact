              on:
                push:
                  branches: [ rollback ]

              jobs:
                sitemap_job:
                  runs-on: ubuntu-latest
                  name: Generate a sitemap

                  steps:
                  - name: Checkout the repo
                    uses: actions/checkout@v3
                    with:
                      fetch-depth: 0 

                  - name: Generate the sitemap
                    id: sitemap
                    uses: cicirello/generate-sitemap@v1.10.0
                    with:
                      base-url-path: https://jsreact.com
                      path-to-root: "./src/"

                  - name: Output stats
                    run: |
                      echo "sitemap-path = ${{ steps.sitemap.outputs.sitemap-path }}"
                      echo "url-count = ${{ steps.sitemap.outputs.url-count }}"
                      echo "excluded-count = ${{ steps.sitemap.outputs.excluded-count }}"

                  - name: Commit and push if changes
                    run: |
                      git config --local user.email "action@github.com"
                      git config --local user.name "GitHub Action"
                      git add -A
                      if [[ $(git diff --stat --staged) != '' ]]; then
                        git commit -m "Add generated sitemap"
                        git push
                      fi
